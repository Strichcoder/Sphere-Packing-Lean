% Sidharth: A lot of this might exist already. We can clear things up quite easily.
% Gareth: lol, not quite

In this section, we recall and develop some theory of (quasi)modular forms.

Let $\h$ be the upper half-plane $\{z\in\C\mid\Im(z)>0\}$.
\begin{lemma}\label{def-Gamma-1-Action}
    The modular group $\Gamma_1:=\mathrm{PSL}_2(\Z)$ acts on $\h$ by linear fractional transformations
$$\left(\begin{smallmatrix}a&b\\c&d\end{smallmatrix}\right)z:=\frac{az+b}{cz+d}.$$
\end{lemma}

Let $N$ be a positive integer.
\begin{definition}\label{def-level-N-princ-cong-subgp}
    The \emph{level $N$ principal congruence subgroup} of $\Gamma_1$ is
    $$\Gamma(N):=\left\{\left.\left(\begin{smallmatrix}a&b\\c&d\end{smallmatrix}\right)\in\Gamma_1\right|\left(\begin{smallmatrix}a&b\\c&d\end{smallmatrix}\right)\equiv\left(\begin{smallmatrix}1&0\\0&1\end{smallmatrix}\right)\;\mathrm{mod}\;N\right\}.$$
\end{definition}

\begin{definition}\label{def-congruence-subgroup}\uses{def-level-N-princ-cong-subgp}
    A subgroup $\Gamma\subset\Gamma_1$ is called a \emph{congruence subgroup} if $\Gamma(N)\subset\Gamma$ for some $N\in\N$.
\end{definition}

An important example of a congruence subgroup is
$$\Gamma_0(N):=\left\{\left.\left(\begin{smallmatrix}a&b\\c&d\end{smallmatrix}\right)\in\Gamma_1\right|\;c\equiv0\;\mathrm{mod}\;N\right\}.$$

Let $z\in\h$, $k\in\Z$, and $\left(\begin{smallmatrix}a&b\\c&d\end{smallmatrix}\right)\in\mathrm{SL}_2(\Z)$.
\begin{definition}\label{def-automorphy-factor}
    The \emph{automorphy factor} of weight $k$ is defined as
$$j_k(z,\left(\begin{smallmatrix}a&b\\c&d\end{smallmatrix}\right)):=(cz+d)^{-k}.$$
\end{definition}

\begin{lemma}\label{lemma-automorphy-factor-chain-rule}\uses{def-automorphy-factor}
    The automorphy factor satisfies the \emph{chain rule}
$$j_k(z,\gamma_1\gamma_2)=j_k(z,\gamma_1)\,j_k(\gamma_2z,\gamma_1). $$
\end{lemma}

\begin{definition}\label{def-slash-operator}\uses{def-automorphy-factor}
    Let $F$ be a  function on $\h$ and $\gamma\in\mathrm{PSL}_2(\Z)$. Then the \emph{slash operator} acts on $F$ by
$$(F|_k\gamma)(z):=j_k(z,\gamma)\,F(\gamma z). $$
\end{definition}

\begin{lemma}\label{lemma-slash-operator-chail-rule}\uses{lemma-automorphy-factor-chain-rule}
    The chain rule implies
$$F|_k\gamma_1\gamma_2=(F|_k\gamma_1)|_k\gamma_2.$$
\end{lemma}

\begin{definition}\label{def-holomorphic-modular-form}\uses{def-congruence-subgroup}% \lean{def-holomorphic-modular-form}
A \emph{(holomorphic) modular form} of integer weight $k$ and congruence subgroup $\Gamma$ is a holomorphic function $f:\h\to\C$ such that:
\begin{enumerate}
  \item $f|_k\gamma=f$ for all $\gamma\in\Gamma$
  \item for each $\alpha\in\Gamma_1\;f|_k\alpha$ has the Fourier expansion $f|_k\alpha (z)=\sum_{n=0}^\infty c_f(\alpha,\frac{n}{n_\alpha})\,e^{2\pi i \frac{n}{n_\alpha}z}$ for some $n_\alpha\in\N$ and Fourier coefficients $c_f(\alpha,m)\in\C$.
\end{enumerate}
\end{definition}

\begin{definition}\label{def-Mk}\uses{def-holomorphic-modular-form}
    Let $M_k(\Gamma)$ be the space of modular forms of weight $k$ and congruence subgroup $\Gamma$.
\end{definition}

A key fact in the theory of modular forms is the following theorem:
\begin{theorem}\label{theorem-Mk-finite-dimensional}\uses{def-Mk}
    The spaces $M_k(\Gamma)$ are finite dimensional.
\end{theorem}

Let us consider several examples of modular forms.
\begin{definition}\label{def-Ek-definition}% \lean{def-Ek-definition}
For an even integer $k\geq 4$ we define the \emph{weight $k$ Eisenstein series} as
\begin{equation}\label{eqn-Ek-definition}
E_k(z):=\frac{1}{2\zeta(k)}\sum_{(c,d)\in\Z^2\backslash(0,0)}(cz+d)^{-k}.\end{equation}
\end{definition}
\begin{lemma}\label{lemma-Ek-is-modular-form}\uses{def-Mk}
    For all $k$, $E_k\in M_k(\Gamma_1)$
\end{lemma}
\begin{proof}
    This follows from the fact that the sum converges absolutely.
\end{proof}

\begin{lemma}\label{lemma-Ek-Fourier}\uses{def-Ek-definition}
% \lean{lemma-Ek-Fourier}\uses{def-Ek-definition}
The Eisenstein series possesses the Fourier expansion
\begin{equation}\label{eqn-Ek-Fourier}E_k(z)=1+\frac{2}{\zeta(1-k)}\sum_{n=1}^\infty \sigma_{k-1}(n)\,e^{2\pi i z}, \end{equation}
where $\sigma_{k-1}(n)\,=\,\sum_{d|n} d^{k-1}$. In particular, we have
\begin{align}
  E_4(z)\,=\,& 1+240\sum_{n=1}^\infty \sigma_3(n)\,e^{2\pi i n z} \notag \\
  E_6(z)\,=\,& 1-504\sum_{n=1}^\infty \sigma_5(n)\,e^{2\pi i n z}. \notag
\end{align}
\end{lemma}\label{lemma-E2-not-abs-conv}
The infinite sum \eqref{eqn-Ek-definition} does not converge absolutely for $k=2$. On the other hand, the expression \eqref{eqn-Ek-Fourier} converges to a holomorphic function on the upper half-plane and therefore
\begin{definition}\label{def-E2} % \lean{def-E2}
We set
\begin{equation}E_2(z):= 1-24\sum_{n=1}^\infty \sigma_1(n)\,e^{2\pi i n z}.\notag\end{equation}
\end{definition}
\begin{lemma}\label{lemma-E2-transform}\uses{def-E2}
This function is not modular, however it satisfies
\begin{equation}\label{eqn-E2-transform}z^{-2}\,E_2\Big(\frac{-1}{z}\Big)=E_2(z) -\frac{6i}{\pi}\, \frac{1}{z}.\end{equation}
\end{lemma}
The proof of this identity can be found in \cite[Section~2.3]{1-2-3}.
The weight two Eisenstein series $E_2$ is an example of a \emph{quasimodular form} \cite[Section~5.1]{1-2-3}.


The discriminant form is a unique normalized cusp form of weight 12, which can be defined using $E_4$ and $E_6$.
\begin{definition}\label{def-disc-definition}% \lean{def-disc-definition}
The \emph{discriminant form} $\Delta(z)$ is given by
\begin{equation}\label{eqn-disc-definition}
\Delta(z) = \frac{E_4(z)^3 - E_6(z)^2}{1728}
\end{equation}
\end{definition}

\begin{lemma}\label{lem-disc-cuspform}
$\Delta(z) \in M_{12}(\Gamma_1)$ and it vanishes at the unique cusp, i.e. it is a cusp form of level $\Gamma_1$ and weight $12$.
\end{lemma}
\begin{proof}
Being a modular form of desired weight and level directly follows from those of $E_4$ and $E_6$.
It is a cusp form since the constant terms of Fourier expansions of $E_4$ and $E_6$ are both $1$.
\end{proof}

It also admits a product formula, which allow us to prove positivity of $\Delta(it)$ for $t > 0$ later.
\begin{lemma}\label{lem-disc-prodformula}
We have
\begin{equation}\label{eqn-disc-prodformula}
\Delta(z) = e^{2 \pi i z} \prod_{n \ge 1} (1 - e^{2 \pi i n z})^{24}.
\end{equation}
\end{lemma}
\begin{proof}
There are several known proofs of this.
One possible proof that we can formalize is from Kohnen \cite{Kohnen}, which prove
\begin{equation}\label{eqn-disc-logder}
    \frac{1}{2\pi i z} \frac{d}{dz}(\log \Delta) = 1 - 24 \sum_{n \ge 1} \frac{ne^{2 \pi i n z}}{1 - e^{2 \pi i n z}}.
\end{equation}
by using a multiplicative analogue of the Hecke operator and the valence formula.
% Here we briefly summarize the proof.
% First of all, it is enough to prove that the logarithmic derivative of $\Delta$ is given by
% \begin{equation}\label{eqn-disc-logder}
%     \frac{1}{2\pi i z} \frac{d}{dz}(\log \Delta) = 1 - 24 \sum_{n \ge 1} \frac{ne^{2 \pi i n z}}{1 - e^{2 \pi i n z}}.
% \end{equation}
% Define the slash action of $\gamma = \left(\begin{smallmatrix}a & b \\ c & d\end{smallmatrix}\right) \in \mathrm{GL}_{2}^{+}(\R)$ as
% \begin{equation}\label{eqn-slash-operator-gl2p}
% (f|_{k} \gamma)(z) := (\det \gamma)^{k/2} j_k(z, \gamma) f(\gamma z).
% \end{equation}
% The ``multiplicative'' Hecke operator $T_{m}^{M}$ of weight $m \ge 1$ is given by
% \begin{equation}\label{eqn-mult-hecke}
% T_{m}^{M}(f) := \prod_{\gamma \in \Gamma_1 \backslash \mathcal{M}(m)} (f|_{m}\gamma)(z)
% \end{equation}
% where
% \begin{equation}\label{eqn-matm}
% \mathcal{M}(m) := \{\gamma in M_{2}(\Z): \det(\gamma) = m\} = \coprod_{\substack{ad = m, d > 0 \\ b\,(\mathrm{mod}\, d)}} \Gamma_1 \begin{pmatrix}a & b \\ 0 & d\end{pmatrix}.
% \end{equation}
% Then $\# \Gamma_1 \backslash \mathcal{M}(m) = \sigma_1(m)$, and for $f \in M_{k}(\Gamma_1)$, we have $T_{m}^{M}(f) \in M_{k \sigma_1(m)}(\Gamma_1)$.
\end{proof}

Note that the RHS of \eqref{eqn-disc-logder} is equal to the $E_2(z)$.
As a side note, we can also consider defining $\Delta$ as \eqref{eqn-disc-prodformula}, and prove that it coincides with \eqref{eqn-disc-definition}.
Such an argument can be found in \cite[Section 2.4]{Bruinier}.

Another example of modular forms we would like to consider are \emph{theta functions} \cite[Section~3.1]{1-2-3}.
\begin{definition}\label{def-th00-th01-th10}
We define three different theta functions (so called ``Thetanullwerte'') as
\begin{align}
  \theta_{00}(z)\,=\, & \sum_{n\in\Z}e^{\pi i n^2 z} \notag \\
  \theta_{01}(z)\,=\, & \sum_{n\in\Z}(-1)^n\,e^{\pi i n^2 z} \notag \\
  \theta_{10}(z)\,=\, & \sum_{n\in\Z}e^{\pi i (n+\frac12)^2 z}. \notag
\end{align}
\end{definition}
The group $\Gamma_1$ is generated by the elements $T=\left(\begin{smallmatrix}1&1\\0&1\end{smallmatrix}\right)$ and $S=\left(\begin{smallmatrix}0&1\\-1&0\end{smallmatrix}\right)$.
\begin{lemma}\label{lemma-theta-transform-S-T}\uses{def-th00-th01-th10}
These elements act on the theta functions in the following way
\begin{align}
z^{-2}\,\theta^4_{00}\Big(\frac{-1}{z}\Big)\,=\,&-\theta_{00}^4(z) \label{eqn: theta transform S}\\
z^{-2}\,\theta^4_{01}\Big(\frac{-1}{z}\Big)\,=\,&-\theta_{10}^4(z) \label{eqn: theta01 transform S}\\
z^{-2}\,\theta^4_{10}\Big(\frac{-1}{z}\Big)\,=\,&-\theta_{01}^4(z) \label{eqn: theta10 transform S}
\end{align}
and
\begin{align}
\theta^4_{00}(z+1)\,=\,&\theta_{01}^4(z) \label{eqn: theta10 transform T}\\
\theta^4_{01}(z+1)\,=\,&\theta_{00}^4(z) \label{eqn: theta01 transform T} \\
\theta^4_{10}(z+1)\,=\,&-\theta_{10}^4(z). \label{eqn: theta transform T}
\end{align}
\end{lemma}
\begin{proof}
The last three identities easily follow from the definition, and \eqref{eqn: theta10 transform S} and \eqref{eqn: theta01 transform S} are equivalent under $z \leftrightarrow -1/z$, so it is enough to show \eqref{eqn: theta transform S} and \eqref{eqn: theta10 transform S}.
These identities follow from the Poisson summation formula, which is already formalized by David Loeffler.
More precisely, for the \emph{two-variable} Jacobi theta function and its derivative (be careful for the variables, here we use $\tau$ instead of $z$)
\begin{equation}
    \theta(z, \tau) = \sum_{n \in \mathbb{Z}} e^{2 \pi i n z + \pi i n^2 \tau} \label{eqn:jacobi2}
\end{equation}
that specialize to $\theta_{00}(\tau) = \theta(0, \tau)$, $\theta_{01} = \theta(1/2, \tau)$, and $\theta_{10}(\tau) = e^{\pi i \tau / 4} \theta(-\tau / 2, \tau)$.
Possion summation formula gives
\begin{equation}
    \theta(z, \tau) = \frac{1}{\sqrt{-i \tau}} e^{-\frac{\pi i z^2}{\tau}} \theta\left(\frac{z}{\tau}, -\frac{1}{\tau}\right) \label{eqn:jacobi2transform}
\end{equation}
and applying the specializations above yield the identities.
For example, \eqref{eqn: theta10 transform S} follows from
\begin{equation}
    \theta_{01}(\tau) = \theta\left(\frac{1}{2}, \tau\right) = \frac{1}{\sqrt{-i\tau}} e^{- \frac{\pi i }{4 \tau}} \theta\left(\frac{1}{2 \tau}, -\frac{1}{\tau}\right) = \frac{1}{\sqrt{-i\tau}} \theta_{10}\left(-\frac{1}{\tau}\right)
\end{equation}
and taking 4th power.
\end{proof}

Using the above identities, we can prove that these are modular forms.
\begin{lemma}\label{lemma-theta-functions-modular-forms}
    The theta functions $\theta^4_{00},\theta^4_{01}$, and $\theta^4_{10}$ belong to $M_2(\Gamma(2))$.
\end{lemma}
\begin{proof}
Since the group $\Gamma(2)$ is generated by two elements
\begin{equation}
    \alpha = \begin{pmatrix}
        1 & 2 \\ 0 & 1
    \end{pmatrix},\quad \beta = \begin{pmatrix}
        1 & 0 \\ 2 & 1
    \end{pmatrix},
\end{equation}
it is enough to show that they are invariant under the slash actions with respect to $\alpha$ and $\beta$.
For $\theta_{01}$, \eqref{eqn: theta01 transform T} and \eqref{eqn: theta01 transform S}
\begin{align}
    (\theta_{01}^{4}|_{2}\alpha)(z) &= \theta_{01}^{4}(z + 2) = \theta_{00}^{4}(z + 1) = \theta_{01}^{4}(z) \\
    (\theta_{01}^{4}|_{2}\beta)(z) &= (2z + 1)^{-2} \theta_{00}^{4}\left(\frac{z}{2z + 1}\right) = (2z + 1)^{-2} \cdot - \left(- \frac{2z + 1}{z}\right)^{2} \theta_{10}^{4} \left(-\frac{2z + 1}{z}\right) \\
    &= -z^{-2} \theta_{10}^{4}\left(-2 - \frac{1}{z}\right)
    = -z^{-2} \theta_{10}^{4}\left(- \frac{1}{z}\right) = \theta_{01}^{4}(z).
\end{align}
We can prove $\theta_{10}^{4}$ and $\theta_{00}^{4}$ similarly.
\end{proof}

We also have a nontrivial relation between these theta functions.
\begin{lemma}\label{lemma-theta-functions-jacobi-identity}
 These three theta functions satisfy the \emph{Jacobi identity}
\begin{equation}
\theta_{01}^4+\theta_{10}^4=\theta_{00}^4.
\end{equation}
\end{lemma}
\begin{proof}
One possible proof is to use dimesion formula of the space of modular forms of weight 2 and level $\Gamma(2)$. Especially, this space have dimension 2, with basis $\theta_{01}^4, \theta_{10}^4$.
\end{proof}

The \emph{strict} positivity of Jacobi theta functions might needed later.
\begin{lemma}\label{lemma-theta-pos}
All three functions $t \mapsto \theta_{01}(it), \theta_{10}(it), \theta_{00}(it)$ are positive for $t > 0$.
\end{lemma}
\begin{proof}
By Lemma \ref{lemma-theta-functions-jacobi-identity} and the transformation law \eqref{eqn: theta01 transform S}, it is enough to prove the positivity for $\theta_{10}(it)$, which is clear from its definition.
\end{proof}

Note that we only need the fourth powers of theta functions in Lemma \ref{lemma-theta-functions-modular-forms} to define \eqref{def: b(r) definition}, not $\theta_{00}, \theta_{01}, \theta_{10}$ themselves.

\begin{definition}\label{def-weakly-holomorphic-modular-form}
A \emph{weakly-holomorphic modular form} of integer weight $k$ and congruence subgroup $\Gamma$ is a holomorphic function $f:\h\to\C$ such that:
\begin{enumerate}
  \item $f|_k\gamma=f$ for all $\gamma\in\Gamma$
  \item for each $\alpha\in\Gamma_1\;f|_k\alpha$ has the Fourier expansion $f|_k\alpha (z)=\sum_{n=n_0}^\infty c_f(\alpha,\frac{n}{n_\alpha})\,e^{2\pi i \frac{n}{n_\alpha}z}$ for some $n_0\in\Z$ and $n_\alpha\in\N$.
\end{enumerate}
\end{definition}
For an $m$-periodic holomorphic function $f$ and $n\in\frac 1m \Z$ we will denote the $n$-th Fourier coefficient of $f$ by $c_f(n)$ so that
$$f(z)=\sum_{n\in\frac 1m \Z} c_f(n)\,e^{2\pi i n z}.$$
We denote the space of weakly-holomorphic modular forms of weight $k$ and group $\Gamma$ by $M_k^!(\Gamma)$. The spaces $M_k^!(\Gamma)$ are infinite dimensional.
Probably the most famous weakly-holomorphic modular form is the \emph{elliptic j-invariant}
$$j\,:=\,\frac{1728\, E_4^3}{E_4^3-E_6^2}. $$
This function belongs to $M_0^!(\Gamma_1)$ and has the Fourier expansion
$$j(z)\,=\,q^{-1} + 744 + 196884\, q + 21493760\, q^2 + 864299970\, q^3 +
  20245856256\, q^4 + O(q^5) $$
  where $q=e^{2\pi i z}$. Using a simple computer algebra system such as PARI GP or Mathematica one can compute first hundred terms of this Fourier expansion within few seconds. An important question is to find an  asymptotic formula for $c_j(n)$, the $n$-th Fourier coefficient  of $j$. Using the Hardy-Ramanujan circle method \cite{Rademacher38} or the non-holomorphic Poincare series \cite{Petersson32} one can show that
  \begin{lemma}\label{lemma: j Fourier asymptotic}
  % \lean{lemma: j Fourier asymptotic}
  \begin{equation}\label{eqn: j Fourier asymptotic}
  c_j(n)=\frac{2\pi}{n}\sum_{k=1}^\infty \frac{A_k(n)}{k}\,I_1\left(\frac{4\pi \sqrt{n}}{k}\right)\qquad n\in\Z_{>0}\end{equation}
  where
  $$A_k(n)= \sum_{\substack{h\;\mathrm{mod}\;k\\(h,k)=1}} e^{\frac{-2\pi i}{k}(nh+h')},\quad hh'\equiv -1(\mbox{mod}\;k),$$
  and $I_\alpha(x)$ denotes the modified Bessel function of the first kind defined as in \cite[Section~9.6]{Abramowitz}.
  \end{lemma}
  A similar convergent asymptotic expansion holds for the Fourier coefficients of any weakly holomorphic modular form \cite{Hejhal}, \cite[Propositions~1.10 and~1.12]{Bruinier}. Such a convergent expansion implies effective estimates for the Fourier coefficients.
